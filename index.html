<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitt Control Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --hue: 195;
            --primary: hsl(var(--hue), 70%, 60%);
            --primary-dim: hsla(var(--hue), 70%, 60%, 0.12);
            --secondary: hsl(calc(var(--hue) + 54), 65%, 55%);
            --tertiary: hsl(calc(var(--hue) + 108), 60%, 50%);
            --bg: #0a0a0a;
            --card: rgba(255, 255, 255, 0.03);
            --card-hover: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.08);
            --border-light: rgba(255, 255, 255, 0.15);
            --text: rgba(255, 255, 255, 0.95);
            --text-mid: rgba(255, 255, 255, 0.55);
            --text-dim: rgba(255, 255, 255, 0.35);
            --red: #f87171;
            --gold: #fbbf24;
            --green: #4ade80;
            --cyan: #22d3ee;
            --purple: #a78bfa;
            --orange: #fb923c;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 32px;
            background: var(--bg);
            border-bottom: 1px solid var(--border);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-container {
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-orb {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%,
                hsla(var(--hue), 70%, 70%, 0.9),
                hsla(var(--hue), 70%, 50%, 0.7),
                hsla(calc(var(--hue) + 54), 65%, 45%, 0.5));
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.05); opacity: 1; }
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .live-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: var(--primary-dim);
            border: 1px solid hsla(var(--hue), 70%, 60%, 0.3);
            border-radius: 24px;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--primary);
            animation: blink 1.5s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .live-text {
            font-size: 12px;
            font-weight: 600;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Main Content */
        .main {
            padding: 32px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Page Title */
        .page-title {
            margin-bottom: 8px;
        }

        .page-title h1 {
            font-size: 36px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 6px;
        }

        .page-title p {
            font-size: 15px;
            color: var(--text-mid);
        }

        /* Category Tabs */
        .category-tabs {
            display: flex;
            gap: 8px;
            margin: 24px 0 32px;
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .category-pill {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid var(--border);
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-mid);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .category-pill:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
        }

        .category-pill.active {
            background: var(--primary);
            border-color: var(--primary);
            color: #fff;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .hero-stat {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 24px;
            transition: all 0.2s ease;
        }

        .hero-stat:hover {
            background: var(--card-hover);
            border-color: var(--border-light);
        }

        .hero-stat-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
        }

        .hero-stat-icon {
            font-size: 16px;
            color: var(--primary);
        }

        .hero-stat-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-mid);
        }

        .hero-stat-value {
            font-size: 48px;
            font-weight: 700;
            color: #fff;
            line-height: 1;
            margin-bottom: 8px;
        }

        .hero-stat-value span {
            font-size: 20px;
            font-weight: 500;
            color: var(--text-mid);
        }

        .hero-stat-change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 13px;
            font-weight: 600;
        }

        .hero-stat-change.positive {
            color: var(--green);
        }

        .hero-stat-change.negative {
            color: var(--red);
        }

        .hero-stat-change .label {
            color: var(--text-dim);
            font-weight: 400;
        }

        /* Cards */
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 28px;
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }

        .card-title-group h2 {
            font-size: 22px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 6px;
        }

        .card-subtitle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--text-mid);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            box-shadow: 0 0 6px currentColor;
        }

        .status-dot.green { background: var(--green); color: var(--green); }
        .status-dot.red { background: var(--red); color: var(--red); }

        .card-big-number {
            font-size: 42px;
            font-weight: 700;
            color: #fff;
        }

        .card-big-number span {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-mid);
        }

        /* Two Column Layout */
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Storage Card */
        .storage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .storage-info h2 {
            font-size: 22px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 4px;
        }

        .storage-info p {
            font-size: 14px;
            color: var(--text-mid);
        }

        .donut-chart {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) calc(var(--percent) * 3.6deg), rgba(255,255,255,0.08) 0);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .donut-chart::before {
            content: '';
            position: absolute;
            width: 60px;
            height: 60px;
            background: var(--bg);
            border-radius: 50%;
        }

        .donut-value {
            position: relative;
            z-index: 1;
            font-size: 18px;
            font-weight: 700;
            color: #fff;
        }

        .drive-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .drive-row {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .drive-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .drive-color {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .drive-name {
            font-size: 15px;
            font-weight: 500;
            color: #fff;
            flex: 1;
        }

        .drive-size {
            font-size: 14px;
            font-weight: 600;
            font-family: 'SF Mono', monospace;
            color: var(--text-mid);
        }

        .drive-percent {
            font-size: 14px;
            font-weight: 700;
            font-family: 'SF Mono', monospace;
        }

        .drive-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 4px;
            overflow: hidden;
        }

        .drive-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Token Stats */
        .token-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .token-box {
            background: rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            padding: 18px;
        }

        .token-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-dim);
            margin-bottom: 6px;
        }

        .token-value {
            font-size: 32px;
            font-weight: 700;
        }

        /* Gauge Row */
        .gauge-row {
            display: flex;
            gap: 20px;
            justify-content: space-around;
        }

        .gauge-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .gauge-circle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: conic-gradient(var(--color, var(--primary)) calc(var(--percent) * 3.6deg), rgba(255,255,255,0.08) 0);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .gauge-circle::before {
            content: '';
            position: absolute;
            width: 54px;
            height: 54px;
            background: var(--bg);
            border-radius: 50%;
        }

        .gauge-value {
            position: relative;
            z-index: 1;
            font-size: 16px;
            font-weight: 700;
            color: #fff;
        }

        .gauge-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-dim);
        }

        .big-number-stat {
            text-align: center;
        }

        .big-number-stat .value {
            font-size: 38px;
            font-weight: 700;
            color: #fff;
        }

        .big-number-stat .label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-dim);
        }

        /* Website List */
        .website-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .website-row {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 14px;
        }

        .website-name {
            font-size: 15px;
            font-weight: 500;
            color: #fff;
            flex: 1;
        }

        .website-latency {
            font-size: 13px;
            font-weight: 500;
            font-family: 'SF Mono', monospace;
            color: var(--text-mid);
        }

        .website-uptime {
            font-size: 13px;
            font-weight: 700;
            font-family: 'SF Mono', monospace;
            color: var(--primary);
        }

        /* Marketing Stats */
        .marketing-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .marketing-stat {
            background: rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            padding: 18px;
        }

        .marketing-stat .value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .marketing-stat .label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-mid);
            margin-bottom: 8px;
        }

        .marketing-stat .change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            font-weight: 600;
            color: var(--green);
        }

        /* Social Rows */
        .social-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .social-row {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 14px;
        }

        .social-icon {
            font-size: 22px;
        }

        .social-info {
            flex: 1;
        }

        .social-name {
            font-size: 15px;
            font-weight: 600;
            color: #fff;
        }

        .social-meta {
            font-size: 13px;
            color: var(--text-dim);
        }

        .social-views {
            font-size: 17px;
            font-weight: 700;
            font-family: 'SF Mono', monospace;
            color: var(--text-mid);
        }

        /* Activity List */
        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .activity-header h2 {
            font-size: 22px;
            font-weight: 600;
            color: #fff;
        }

        .view-all {
            font-size: 14px;
            font-weight: 500;
            color: var(--primary);
            cursor: pointer;
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .activity-row {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 14px;
        }

        .activity-message {
            font-size: 15px;
            font-weight: 500;
            color: #fff;
            flex: 1;
        }

        .activity-time {
            font-size: 13px;
            font-weight: 500;
            font-family: 'SF Mono', monospace;
            color: var(--text-dim);
        }

        /* Responsive */
        @media (max-width: 1100px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 800px) {
            .main {
                padding: 20px;
            }

            .two-col {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .hero-stat-value {
                font-size: 36px;
            }

            .marketing-grid {
                grid-template-columns: 1fr;
            }

            .page-title h1 {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo-container">
                <div class="logo-orb"></div>
                <span class="logo">Kitt</span>
            </div>
        </div>
        <div class="header-right">
            <div class="live-badge">
                <div class="live-dot" id="live-dot"></div>
                <span class="live-text" id="live-text">Live</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="page-title">
            <h1>Dashboard</h1>
            <p>Your systems at a glance</p>
        </div>

        <!-- Category Tabs -->
        <div class="category-tabs">
            <div class="category-pill active">Overview</div>
            <div class="category-pill">Mac Health</div>
            <div class="category-pill">AI Usage</div>
            <div class="category-pill">Websites</div>
            <div class="category-pill">Marketing</div>
        </div>

        <!-- Hero Stats -->
        <div class="stats-grid">
            <div class="hero-stat">
                <div class="hero-stat-header">
                    <span class="hero-stat-icon">üíª</span>
                    <span class="hero-stat-title">CPU Usage</span>
                </div>
                <div class="hero-stat-value" id="cpu-value">23<span>%</span></div>
                <div class="hero-stat-change positive">
                    <span>‚Üì 5%</span>
                    <span class="label">vs yesterday</span>
                </div>
            </div>

            <div class="hero-stat">
                <div class="hero-stat-header">
                    <span class="hero-stat-icon">üß†</span>
                    <span class="hero-stat-title">Memory</span>
                </div>
                <div class="hero-stat-value" id="mem-value">67<span>%</span></div>
                <div class="hero-stat-change negative">
                    <span>‚Üë 12%</span>
                    <span class="label">vs yesterday</span>
                </div>
            </div>

            <div class="hero-stat">
                <div class="hero-stat-header">
                    <span class="hero-stat-icon">‚ö°</span>
                    <span class="hero-stat-title">Processes</span>
                </div>
                <div class="hero-stat-value" id="process-count">142</div>
                <div class="hero-stat-change positive">
                    <span>‚Üì 8</span>
                    <span class="label">vs yesterday</span>
                </div>
            </div>

            <div class="hero-stat">
                <div class="hero-stat-header">
                    <span class="hero-stat-icon">üåê</span>
                    <span class="hero-stat-title">Websites</span>
                </div>
                <div class="hero-stat-value">4<span> sites</span></div>
                <div class="hero-stat-change positive">
                    <span class="status-dot green"></span>
                    <span class="label">All operational</span>
                </div>
            </div>
        </div>

        <!-- Two Column Layout -->
        <div class="two-col">
            <!-- Storage Card -->
            <div class="card">
                <div class="storage-header">
                    <div class="storage-info">
                        <h2>Storage</h2>
                        <p id="storage-summary">4,462 GB of 7,500 GB used</p>
                    </div>
                    <div class="donut-chart" id="storage-chart" style="--percent: 60">
                        <span class="donut-value" id="storage-percent">60%</span>
                    </div>
                </div>
                <div class="drive-list" id="drives-container">
                    <div class="drive-row">
                        <div class="drive-info">
                            <div class="drive-color" style="background: var(--cyan)"></div>
                            <span class="drive-name">Macintosh HD</span>
                            <span class="drive-size">412 GB</span>
                            <span class="drive-percent" style="color: var(--cyan)">82%</span>
                        </div>
                        <div class="drive-bar">
                            <div class="drive-bar-fill" style="width: 82%; background: var(--cyan)"></div>
                        </div>
                    </div>
                    <div class="drive-row">
                        <div class="drive-info">
                            <div class="drive-color" style="background: var(--purple)"></div>
                            <span class="drive-name">5TB External</span>
                            <span class="drive-size">2847 GB</span>
                            <span class="drive-percent" style="color: var(--purple)">57%</span>
                        </div>
                        <div class="drive-bar">
                            <div class="drive-bar-fill" style="width: 57%; background: var(--purple)"></div>
                        </div>
                    </div>
                    <div class="drive-row">
                        <div class="drive-info">
                            <div class="drive-color" style="background: var(--orange)"></div>
                            <span class="drive-name">2TB Backup</span>
                            <span class="drive-size">1203 GB</span>
                            <span class="drive-percent" style="color: var(--orange)">60%</span>
                        </div>
                        <div class="drive-bar">
                            <div class="drive-bar-fill" style="width: 60%; background: var(--orange)"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Usage Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title-group">
                        <div class="card-subtitle">
                            <span class="status-dot green"></span>
                            <span id="ai-model">Claude Opus 4.5</span>
                        </div>
                        <h2>AI Usage</h2>
                    </div>
                    <div class="card-big-number" id="ai-cost">$0.42</div>
                </div>
                <div class="token-grid">
                    <div class="token-box">
                        <div class="token-label">Tokens In</div>
                        <div class="token-value" id="ai-tokens-in" style="color: var(--primary)">12.4K</div>
                    </div>
                    <div class="token-box">
                        <div class="token-label">Tokens Out</div>
                        <div class="token-value" id="ai-tokens-out" style="color: var(--secondary)">8.7K</div>
                    </div>
                </div>
                <div class="gauge-row">
                    <div class="gauge-item">
                        <div class="gauge-circle" id="cache-gauge" style="--percent: 73; --color: var(--primary)">
                            <span class="gauge-value" id="cache-value">73%</span>
                        </div>
                        <span class="gauge-label">Cache Hit</span>
                    </div>
                    <div class="gauge-item">
                        <div class="gauge-circle" id="ctx-gauge" style="--percent: 45; --color: var(--secondary)">
                            <span class="gauge-value" id="ctx-value">45%</span>
                        </div>
                        <span class="gauge-label">Context</span>
                    </div>
                    <div class="big-number-stat">
                        <div class="value" id="compaction-count">2</div>
                        <div class="label">Compactions</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Websites Card -->
        <div class="card">
            <div class="card-header">
                <div class="card-title-group">
                    <h2>Websites</h2>
                    <div class="card-subtitle">
                        <span class="status-dot green"></span>
                        <span>All systems operational</span>
                    </div>
                </div>
                <div class="card-big-number">4<span> sites</span></div>
            </div>
            <div class="website-list" id="websites-container">
                <div class="website-row">
                    <span class="status-dot green"></span>
                    <span class="website-name">eccoti.com</span>
                    <span class="website-latency">142ms</span>
                    <span class="website-uptime">99.98%</span>
                </div>
                <div class="website-row">
                    <span class="status-dot green"></span>
                    <span class="website-name">backtime.app</span>
                    <span class="website-latency">98ms</span>
                    <span class="website-uptime">99.99%</span>
                </div>
                <div class="website-row">
                    <span class="status-dot green"></span>
                    <span class="website-name">api.eccoti.com</span>
                    <span class="website-latency">67ms</span>
                    <span class="website-uptime">100%</span>
                </div>
                <div class="website-row">
                    <span class="status-dot green"></span>
                    <span class="website-name">jmedinaphotos.surge.sh</span>
                    <span class="website-latency">89ms</span>
                    <span class="website-uptime">99.97%</span>
                </div>
            </div>
        </div>

        <!-- Marketing Card -->
        <div class="card">
            <div class="card-header">
                <div class="card-title-group">
                    <h2>Marketing</h2>
                </div>
            </div>
            <div class="marketing-grid" id="marketing-stats">
                <div class="marketing-stat">
                    <div class="value" style="color: var(--primary)">12.4K</div>
                    <div class="label">Views</div>
                    <div class="change">‚Üë +18%</div>
                </div>
                <div class="marketing-stat">
                    <div class="value" style="color: var(--secondary)">2.7K</div>
                    <div class="label">Likes</div>
                    <div class="change">‚Üë +12%</div>
                </div>
                <div class="marketing-stat">
                    <div class="value" style="color: var(--tertiary)">+519</div>
                    <div class="label">Followers</div>
                    <div class="change">‚Üë +8%</div>
                </div>
            </div>
            <div class="social-list" id="marketing-container">
                <div class="social-row">
                    <span class="social-icon">üéµ</span>
                    <div class="social-info">
                        <div class="social-name">TikTok</div>
                        <div class="social-meta">2 accounts</div>
                    </div>
                    <span class="social-views">17.5K</span>
                </div>
                <div class="social-row">
                    <span class="social-icon">üì∑</span>
                    <div class="social-info">
                        <div class="social-name">Instagram</div>
                        <div class="social-meta">1 account</div>
                    </div>
                    <span class="social-views">8.2K</span>
                </div>
            </div>
        </div>

        <!-- Recent Activity Card -->
        <div class="card">
            <div class="activity-header">
                <h2>Recent Activity</h2>
                <span class="view-all">View all</span>
            </div>
            <div class="activity-list" id="alerts-container">
                <div class="activity-row">
                    <span class="status-dot green"></span>
                    <span class="activity-message">Nightly backup completed</span>
                    <span class="activity-time">4h ago</span>
                </div>
                <div class="activity-row">
                    <span class="status-dot green"></span>
                    <span class="activity-message">TikTok metrics synced</span>
                    <span class="activity-time">6h ago</span>
                </div>
                <div class="activity-row">
                    <span class="status-dot" style="background: #60a5fa; color: #60a5fa"></span>
                    <span class="activity-message">eccoti.com SSL renewed</span>
                    <span class="activity-time">1d ago</span>
                </div>
                <div class="activity-row">
                    <span class="status-dot" style="background: var(--gold); color: var(--gold)"></span>
                    <span class="activity-message">Disk cleanup recommended</span>
                    <span class="activity-time">2d ago</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getFirestore, doc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        // Firebase config for kitt-control-center
        const firebaseConfig = {
            apiKey: "AIzaSyCdlA7zbP0Tf8ziq06_alvyyRPxsIRMY0s",
            authDomain: "kitt-control-center.firebaseapp.com",
            projectId: "kitt-control-center",
            storageBucket: "kitt-control-center.firebasestorage.app",
            messagingSenderId: "1070476598443",
            appId: "1:1070476598443:web:13c1b47f4a49ade97b6bee",
            measurementId: "G-6FP21GTV5R"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Helpers
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function timeAgo(timestamp) {
            if (!timestamp) return '';
            const now = new Date();
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            const diff = Math.floor((now - date) / 1000);
            if (diff < 60) return 'just now';
            if (diff < 3600) return Math.floor(diff / 60) + 'm ago';
            if (diff < 86400) return Math.floor(diff / 3600) + 'h ago';
            return Math.floor(diff / 86400) + 'd ago';
        }

        function setConnected(connected) {
            const dot = document.getElementById('live-dot');
            const text = document.getElementById('live-text');
            if (dot && text) {
                dot.style.background = connected ? 'var(--primary)' : 'var(--red)';
                dot.style.boxShadow = connected ? '0 0 8px var(--primary)' : '0 0 8px var(--red)';
                text.textContent = connected ? 'Live' : 'Offline';
                text.style.color = connected ? 'var(--primary)' : 'var(--red)';
            }
        }

        // Listen to Mac Health
        onSnapshot(doc(db, 'kitt', 'macHealth'), (snapshot) => {
            if (!snapshot.exists()) return;
            const data = snapshot.data();
            setConnected(true);

            if (data.cpu !== undefined) {
                document.getElementById('cpu-value').innerHTML = data.cpu + '<span>%</span>';
            }
            if (data.memory !== undefined) {
                document.getElementById('mem-value').innerHTML = data.memory + '<span>%</span>';
            }
            if (data.processes !== undefined) {
                document.getElementById('process-count').textContent = data.processes;
            }

            // Update drives
            if (data.drives) {
                const colors = ['var(--cyan)', 'var(--purple)', 'var(--orange)', 'var(--green)'];
                let totalUsed = 0, totalCapacity = 0;

                const drivesHTML = data.drives.map((drive, i) => {
                    const percent = Math.round((drive.used / drive.total) * 100);
                    const color = colors[i % colors.length];
                    totalUsed += drive.used;
                    totalCapacity += drive.total;
                    return `
                        <div class="drive-row">
                            <div class="drive-info">
                                <div class="drive-color" style="background: ${color}"></div>
                                <span class="drive-name">${drive.name}</span>
                                <span class="drive-size">${drive.used} GB</span>
                                <span class="drive-percent" style="color: ${color}">${percent}%</span>
                            </div>
                            <div class="drive-bar">
                                <div class="drive-bar-fill" style="width: ${percent}%; background: ${color}"></div>
                            </div>
                        </div>
                    `;
                }).join('');

                document.getElementById('drives-container').innerHTML = drivesHTML;

                const totalPercent = Math.round((totalUsed / totalCapacity) * 100);
                document.getElementById('storage-summary').textContent = `${totalUsed.toLocaleString()} GB of ${totalCapacity.toLocaleString()} GB used`;
                document.getElementById('storage-chart').style.setProperty('--percent', totalPercent);
                document.getElementById('storage-percent').textContent = totalPercent + '%';
            }
        }, (error) => {
            console.error('Mac Health error:', error);
            setConnected(false);
        });

        // Listen to AI Usage
        onSnapshot(doc(db, 'kitt', 'aiUsage'), (snapshot) => {
            if (!snapshot.exists()) return;
            const data = snapshot.data();

            if (data.model) document.getElementById('ai-model').textContent = data.model;
            if (data.tokensIn !== undefined) document.getElementById('ai-tokens-in').textContent = formatNumber(data.tokensIn);
            if (data.tokensOut !== undefined) document.getElementById('ai-tokens-out').textContent = formatNumber(data.tokensOut);
            if (data.estimatedCost !== undefined) document.getElementById('ai-cost').textContent = '$' + data.estimatedCost.toFixed(2);

            if (data.cacheHitPercent !== undefined) {
                document.getElementById('cache-gauge').style.setProperty('--percent', data.cacheHitPercent);
                document.getElementById('cache-value').textContent = data.cacheHitPercent + '%';
            }
            if (data.contextUsedPercent !== undefined) {
                document.getElementById('ctx-gauge').style.setProperty('--percent', data.contextUsedPercent);
                document.getElementById('ctx-value').textContent = data.contextUsedPercent + '%';
            }
            if (data.compactionCount !== undefined) {
                document.getElementById('compaction-count').textContent = data.compactionCount;
            }
        });

        // Listen to Websites
        onSnapshot(doc(db, 'kitt', 'websites'), (snapshot) => {
            if (!snapshot.exists()) return;
            const data = snapshot.data();

            if (data.sites) {
                document.getElementById('websites-container').innerHTML = data.sites.map(site => `
                    <div class="website-row">
                        <span class="status-dot ${site.status === 'up' ? 'green' : 'red'}"></span>
                        <span class="website-name">${site.name}</span>
                        <span class="website-latency">${site.latency}ms</span>
                        <span class="website-uptime">${site.uptime}%</span>
                    </div>
                `).join('');
            }
        });

        // Listen to Alerts
        onSnapshot(doc(db, 'kitt', 'alerts'), (snapshot) => {
            if (!snapshot.exists()) return;
            const data = snapshot.data();

            if (data.items) {
                const typeColors = {
                    success: 'var(--green)',
                    warning: 'var(--gold)',
                    error: 'var(--red)',
                    info: '#60a5fa'
                };
                document.getElementById('alerts-container').innerHTML = data.items.slice(0, 5).map(alert => `
                    <div class="activity-row">
                        <span class="status-dot" style="background: ${typeColors[alert.type] || 'var(--primary)'}; color: ${typeColors[alert.type] || 'var(--primary)'}"></span>
                        <span class="activity-message">${alert.message}</span>
                        <span class="activity-time">${timeAgo(alert.timestamp)}</span>
                    </div>
                `).join('');
            }
        });

        // Listen to Marketing
        onSnapshot(doc(db, 'kitt', 'marketing'), (snapshot) => {
            if (!snapshot.exists()) return;
            const data = snapshot.data();

            let html = '';
            if (data.tiktok) {
                data.tiktok.forEach(acc => {
                    html += `
                        <div class="social-row">
                            <span class="social-icon">üéµ</span>
                            <div class="social-info">
                                <div class="social-name">TikTok - ${acc.account}</div>
                                <div class="social-meta">${formatNumber(acc.likes)} likes</div>
                            </div>
                            <span class="social-views">${formatNumber(acc.views)}</span>
                        </div>
                    `;
                });
            }
            if (data.instagram) {
                data.instagram.forEach(acc => {
                    html += `
                        <div class="social-row">
                            <span class="social-icon">üì∑</span>
                            <div class="social-info">
                                <div class="social-name">Instagram - ${acc.account}</div>
                                <div class="social-meta">${acc.engagement}% engagement</div>
                            </div>
                            <span class="social-views">${formatNumber(acc.reach)}</span>
                        </div>
                    `;
                });
            }
            if (html) document.getElementById('marketing-container').innerHTML = html;
        });

        console.log('Kitt Dashboard initialized');
    </script>
</body>
</html>
